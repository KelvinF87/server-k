<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SERVER-K API Documentation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }
        h1, h2, h3 {
            color: #444;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        p {
            margin-bottom: 15px;
        }
        code {
            background-color: #eee;
            padding: 2px 5px;
            border-radius: 4px;
            font-family: monospace;
        }
        pre {
            background-color: #eee;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-family: monospace;
        }
        .endpoint {
            margin-bottom: 20px;
            border: 1px solid #ddd;
            padding: 10px;
            background-color: #fff;
            border-radius: 4px;
        }
        .method {
            font-weight: bold;
            color: #fff;
            background-color: #337ab7;
            padding: 5px 10px;
            border-radius: 4px;
            margin-right: 10px;
        }
        .description {
            margin-top: 10px;
            font-style: italic;
        }
        .example {
            margin-top: 10px;
        }
        .parameter-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .parameter-table th, .parameter-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .parameter-table th {
            background-color: #f0f0f0;
        }
        .required {
            color: red;
        }

    </style>
</head>
<body>

    <h1>SERVER-K API Documentation</h1>

    <p>Welcome to the SERVER-K API documentation. This document provides information on how to use the API endpoints for managing users, authentication, expenses, income, and entry types.  All API requests require a valid JWT token in the <code>Authorization</code> header (<code>Bearer <token></code>) except for the authentication endpoints.</p>

    <h2>Authentication Endpoints (/auth)</h2>

    <div class="endpoint">
        <span class="method">POST</span> <code>/auth/signup</code>
        <p class="description">Registers a new user.</p>
        <h3>Request Body:</h3>
        <pre>
<code>
{
  "username": "newuser", <span class="required">required</span>,
  "email": "newuser@example.com", <span class="required">required</span>,
  "password": "securePassword", <span class="required">required</span>,
  "name": "John", <span class="required">required</span>,
  "lastname": "Doe", <span class="required">required</span>,
  "roles": ["user"], <span class="required">required</span>,
  "active": true,
  "image": "URL_to_image"
}
</code>
        </pre>
        <h3>Response:</h3>
        <pre>
<code>
{
  "_id": "...",
  "username": "newuser",
  "email": "newuser@example.com",
  "name": "John",
  "lastname": "Doe",
  "roles": ["user"],
  "active": true,
  "image": "URL_to_image",
  "createdAt": "...",
  "updatedAt": "..."
}
</code>
        </pre>
    </div>

    <div class="endpoint">
        <span class="method">POST</span> <code>/auth/login</code>
        <p class="description">Authenticates a user and returns a JWT token.</p>
        <h3>Request Body:</h3>
        <pre>
<code>
{
  "username": "existinguser", <span class="required">required</span>,
  "password": "password" <span class="required">required</span>
}
</code>
        </pre>
        <h3>Response:</h3>
        <pre>
<code>
{
  "authToken": "JWT_TOKEN"
}
</code>
        </pre>
    </div>

    <div class="endpoint">
        <span class="method">GET</span> <code>/auth/verify</code>
        <p class="description">Verifies a JWT token and returns the payload. Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Response:</h3>
        <pre>
<code>
{
  "_id": "...",
  "username": "existinguser",
  "name": "John",
  "roles": ["user"],
  "iat": "...",
  "exp": "..."
}
</code>
        </pre>
    </div>

    <h2>User Endpoints (/api/users)</h2>

    <div class="endpoint">
        <span class="method">GET</span> <code>/api/users/:id</code>
        <p class="description">Retrieves user information by ID. Requires a valid JWT token and the user ID must match the token's user ID.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Response:</h3>
        <pre>
<code>
{
  "_id": "...",
  "username": "user1",
  "email": "user1@example.com",
  "name": "John",
  "lastname": "Doe",
  "roles": ["user"],
  "active": true,
  "image": "URL_to_image",
  "createdAt": "...",
  "updatedAt": "..."
}
</code>
        </pre>
    </div>

    <h2>Expense Endpoints (/api/gastos)</h2>

    <div class="endpoint">
        <span class="method">POST</span> <code>/api/gastos</code>
        <p class="description">Creates a new expense. Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Request Body:</h3>
        <pre>
<code>
{
  "gasto": 100, <span class="required">required</span>,
  "tipo": "tipoEntradaId", <span class="required">required</span>,
  "detalles": "Lunch with client" <span class="required">required</span>
}
</code>
        </pre>
        <h3>Response:</h3>
        <pre>
<code>
{
  "_id": "...",
  "gasto": 100,
  "tipo": "tipoEntradaId",
  "balance": 0,
  "detalles": "Lunch with client",
  "user": "userId",
  "createdAt": "...",
  "updatedAt": "..."
}
</code>
        </pre>
    </div>

    <div class="endpoint">
        <span class="method">GET</span> <code>/api/gastos</code>
        <p class="description">Retrieves all expenses for the authenticated user (or all expenses if the user has the "admin" role). Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Response:</h3>
        <pre>
<code>
[
  {
    "_id": "...",
    "gasto": 100,
    "tipo": { "_id": "...", "name": "Food", "tipo": ["Gasto"], "createdAt": "...", "updatedAt": "..."},
    "balance": 0,
    "detalles": "Lunch with client",
    "user": "userId",
    "createdAt": "...",
    "updatedAt": "..."
  },
  ...
]
</code>
        </pre>
    </div>

     <div class="endpoint">
        <span class="method">GET</span> <code>/api/gastos/:id</code>
        <p class="description">Retrieves a specific expense by ID. Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Response:</h3>
        <pre>
<code>
{
  "_id": "...",
  "gasto": 100,
  "tipo": { "_id": "...", "name": "Food", "tipo": ["Gasto"], "createdAt": "...", "updatedAt": "..."},
  "balance": 0,
  "detalles": "Lunch with client",
  "user": "userId",
  "createdAt": "...",
  "updatedAt": "..."
}
</code>
        </pre>
    </div>

        <div class="endpoint">
        <span class="method">PUT</span> <code>/api/gastos/:id</code>
        <p class="description">Updates a specific expense by ID. Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Request Body:</h3>
        <pre>
<code>
{
  "gasto": 120,
  "detalles": "Updated lunch details"
}
</code>
        </pre>
        <h3>Response:</h3>
        <pre>
<code>
{
  "_id": "...",
  "gasto": 120,
  "tipo": "tipoEntradaId",
  "balance": 0,
  "detalles": "Updated lunch details",
  "user": "userId",
  "createdAt": "...",
  "updatedAt": "..."
}
</code>
        </pre>
    </div>

    <div class="endpoint">
        <span class="method">DELETE</span> <code>/api/gastos/:id</code>
        <p class="description">Deletes a specific expense by ID. Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Response:</h3>
        <p>204 No Content (on success)</p>
    </div>

    <h2>Income Endpoints (/api/ingresos)</h2>

       <div class="endpoint">
        <span class="method">POST</span> <code>/api/ingresos</code>
        <p class="description">Creates a new income. Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Request Body:</h3>
        <pre>
<code>
{
  "ingreso": 1000, <span class="required">required</span>,
  "tipo": "tipoEntradaId", <span class="required">required</span>,
  "detalles": "Salary" <span class="required">required</span>
}
</code>
        </pre>
        <h3>Response:</h3>
        <pre>
<code>
{
  "_id": "...",
  "ingreso": 1000,
  "tipo": "tipoEntradaId",
  "balance": 0,
  "detalles": "Salary",
  "user": "userId",
  "createdAt": "...",
  "updatedAt": "..."
}
</code>
        </pre>
    </div>

    <div class="endpoint">
        <span class="method">GET</span> <code>/api/ingresos</code>
        <p class="description">Retrieves all incomes for the authenticated user (or all incomes if the user has the "admin" role). Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Response:</h3>
        <pre>
<code>
[
  {
    "_id": "...",
    "ingreso": 1000,
    "tipo": { "_id": "...", "name": "Salary", "tipo": ["ingreso"], "createdAt": "...", "updatedAt": "..."},
    "balance": 0,
    "detalles": "Salary",
    "user": "userId",
    "createdAt": "...",
    "updatedAt": "..."
  },
  ...
]
</code>
        </pre>
    </div>

     <div class="endpoint">
        <span class="method">GET</span> <code>/api/ingresos/:id</code>
        <p class="description">Retrieves a specific income by ID. Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Response:</h3>
        <pre>
<code>
{
  "_id": "...",
  "ingreso": 1000,
  "tipo": { "_id": "...", "name": "Salary", "tipo": ["ingreso"], "createdAt": "...", "updatedAt": "..."},
  "balance": 0,
  "detalles": "Salary",
  "user": "userId",
  "createdAt": "...",
  "updatedAt": "..."
}
</code>
        </pre>
    </div>

        <div class="endpoint">
        <span class="method">PUT</span> <code>/api/ingresos/:id</code>
        <p class="description">Updates a specific income by ID. Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Request Body:</h3>
        <pre>
<code>
{
  "ingreso": 1200,
  "detalles": "Updated salary details"
}
</code>
        </pre>
        <h3>Response:</h3>
        <pre>
<code>
{
  "_id": "...",
  "ingreso": 1200,
  "tipo": "tipoEntradaId",
  "balance": 0,
  "detalles": "Updated salary details",
  "user": "userId",
  "createdAt": "...",
  "updatedAt": "..."
}
</code>
        </pre>
    </div>

    <div class="endpoint">
        <span class="method">DELETE</span> <code>/api/ingresos/:id</code>
        <p class="description">Deletes a specific income by ID. Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Response:</h3>
        <p>204 No Content (on success)</p>
    </div>

    <h2>Entry Type Endpoints (/api/tipo-entradas)</h2>

    <div class="endpoint">
        <span class="method">POST</span> <code>/api/tipo-entradas</code>
        <p class="description">Creates a new entry type. Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Request Body:</h3>
        <pre>
<code>
{
  "name": "Food", <span class="required">required</span>,
  "tipo": ["Gasto"] <span class="required">required</span>
}
</code>
        </pre>
        <h3>Response:</h3>
        <pre>
<code>
{
  "_id": "...",
  "name": "Food",
  "tipo": ["Gasto"],
  "createdAt": "...",
  "updatedAt": "..."
}
</code>
        </pre>
    </div>

    <div class="endpoint">
        <span class="method">GET</span> <code>/api/tipo-entradas</code>
        <p class="description">Retrieves all entry types. Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Response:</h3>
        <pre>
<code>
[
  {
    "_id": "...",
    "name": "Food",
    "tipo": ["Gasto"],
    "createdAt": "...",
    "updatedAt": "..."
  },
  ...
]
</code>
        </pre>
    </div>

    <div class="endpoint">
        <span class="method">GET</span> <code>/api/tipo-entradas/:id</code>
        <p class="description">Retrieves a specific entry type by ID. Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Response:</h3>
        <pre>
<code>
{
  "_id": "...",
  "name": "Food",
  "tipo": ["Gasto"],
  "createdAt": "...",
  "updatedAt": "..."
}
</code>
        </pre>
    </div>

    <div class="endpoint">
        <span class="method">PUT</span> <code>/api/tipo-entradas/:id</code>
        <p class="description">Updates a specific entry type by ID. Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Request Body:</h3>
        <pre>
<code>
{
  "name": "Updated Food",
  "tipo": ["Gasto"]
}
</code>
        </pre>
        <h3>Response:</h3>
        <pre>
<code>
{
  "_id": "...",
  "name": "Updated Food",
  "tipo": ["Gasto"],
  "createdAt": "...",
  "updatedAt": "..."
}
</code>
        </pre>
    </div>

    <div class="endpoint">
        <span class="method">DELETE</span> <code>/api/tipo-entradas/:id</code>
        <p class="description">Deletes a specific entry type by ID. Requires a valid JWT token.</p>
        <h3>Headers:</h3>
        <pre><code>Authorization: Bearer JWT_TOKEN</code></pre>
        <h3>Response:</h3>
        <p>204 No Content (on success)</p>
    </div>

    <p>This documentation provides a general overview of the API endpoints.  For more specific details, please consult the API source code.</p>

</body>
</html>